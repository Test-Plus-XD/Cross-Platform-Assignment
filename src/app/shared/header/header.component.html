<!-- Shared header: brand, nav links, language and theme controls -->
<header id="app-shared-header">
  <ion-header [translucent]="true">
    <ion-toolbar>
      <!-- Start slot: menu + brand (on non-mobile) -->
      <div slot="start" class="header-start">
        <ng-container *ngIf="(showHeaderMenu$ | async)">
          <ion-button (click)="onMenuButtonClicked()" fill="clear" size="small" color="medium" aria-label="Toggle menu">
            <ion-icon slot="icon-only" name="menu"></ion-icon>
          </ion-button>
        </ng-container>

        <ng-container *ngIf="!(isMobile$ | async)">
          <ion-title class="brand-title">
            <img [src]="brandIcon$ | async" alt="Brand"
                 class="brand-img" />
          </ion-title>
        </ng-container>
      </div>

      <!-- Centre title: show brand on mobile, page title on desktop -->
      <ion-title class="toolbar-title text-center">
        <!-- Mobile: Show brand image -->
        <ng-container *ngIf="(isMobile$ | async)">
          <img [src]="brandIcon$ | async" alt="Brand" class="mobile-brand-img" />
        </ng-container>
        <!-- Desktop: Show page title -->
        <ng-container *ngIf="!(isMobile$ | async) && (pageTitle$ | async) as pageTitle">
          {{
          (lang$ | async) === 'TC'
            ? (pageTitle.Header_TC || '&nbsp;')
            : (pageTitle.Header_EN || '&nbsp;')
          }}
        </ng-container>
      </ion-title>

      <!-- End slot: nav links + toggles (on non-mobile) -->
      <div slot="end" class="header-end" *ngIf="!(isMobile$ | async)">
        <a routerLink="/login" class="nav-link">
          {{ (lang$ | async) === 'TC' ? 'ç™»å…¥' : 'Login' }}
        </a>
        <a routerLink="/search" class="nav-link">
          {{ (lang$ | async) === 'TC' ? 'æœå°‹' : 'Search' }}
        </a>
        <div class="lang-toggle">
          <button (click)="setLang('EN')" class="lang-btn">ğŸ‡¬ğŸ‡§</button>
          |
          <button (click)="setLang('TC')" class="lang-btn">ğŸ‡­ğŸ‡°</button>
        </div>
        <button (click)="toggleTheme()"
                class="theme-btn"
                aria-label="Toggle theme">
          <ng-container *ngIf="isDark$ | async; else sunIcon">ğŸŒ’</ng-container>
          <ng-template #sunIcon>â˜€ï¸</ng-template>
        </button>
      </div>
    </ion-toolbar>
  </ion-header>
</header>