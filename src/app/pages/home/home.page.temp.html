<!-- Page root: ion-content keeps Ionic behaviour -->
<ion-content class="min-h-screen bg-slate-50 dark:bg-slate-900">
  <!-- Main container -->
  <main class="mx-auto max-w-6xl p-4">

    <!-- Header: branding + nav -->
    <!-- Header row: brand + nav controls -->
    <header class="mb-4 flex items-center justify-between">
      <!-- Brand: icon or text -->
      <div class="flex items-center gap-3">
        <!-- Show brand icon or fallback text -->
        <ng-container *ngIf="isDark$ | async as isDark">
          <img [src]="isDark ? 'assets/icon/App-Dark.png' : 'assets/icon/App-Light.png'"
               alt="Pour Rice" class="h-10 w-10 object-contain" />
        </ng-container>
        <span class="hidden text-xl font-bold text-slate-900 sm:inline dark:text-slate-100">Pour Rice / 倒米</span>
      </div>

      <!-- Nav controls -->
      <nav class="flex items-center gap-3">
        <!-- Login -->
        <a class="text-sm text-slate-700 dark:text-slate-200" routerLink="/login">Login</a>
        <!-- Search (link to app search page) -->
        <a class="text-sm text-slate-700 dark:text-slate-200" routerLink="/search">Search</a>
        <!-- Language toggle -->
        <button (click)="setLang('EN')" class="px-2 py-1 text-slate-700 dark:text-slate-200">🇬🇧</button>
        <button (click)="setLang('TC')" class="px-2 py-1 text-slate-700 dark:text-slate-200">🇭🇰</button>
        <!-- Theme toggle -->
        <button (click)="toggleTheme()" class="rounded border bg-white px-2 py-1 dark:border-slate-700 dark:bg-slate-800">
          <ng-container *ngIf="(isDark$ | async); else sun">☾</ng-container>
          <ng-template #sun>☀</ng-template>
        </button>
      </nav>
    </header>

    <!-- Hero / Ads carousel: horizontal scroll of clickable images -->
    <!-- Ads carousel: horizontally scrollable banners -->
    <section class="mb-6">
      <div class="flex snap-x snap-mandatory gap-3 overflow-x-auto pb-3">
        <a *ngFor="let a of (ads$ | async || [])" [href]="a.href" class="w-[min(900px,90vw)] flex-shrink-0 snap-center">
          <img [src]="a.image || 'assets/img/placeholder.jpg'" alt="ad" class="h-44 w-full rounded-lg object-cover" />
        </a>
      </div>
      <!-- Large featured image (changes on offer hover/click) -->
      <div class="mt-4 overflow-hidden rounded-lg bg-white shadow dark:bg-slate-800">
        <img [src]="featuredImage || (offers$ | async)?.[0]?.image || 'assets/img/placeholder.jpg'" alt="featured" class="h-52 w-full object-cover" />
      </div>
    </section>

    <!-- Special offers: small promo cards, hover sets featured image -->
    <!-- Offers: horizontal small cards -->
    <section class="mt-6">
      <div class="mb-3 flex items-center justify-between">
        <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">
          {{ (lang$ | async) === 'TC' ? '甄選優惠' : 'Featured offers' }}
        </h3>
        <a class="text-sm text-indigo-600 dark:text-indigo-400" routerLink="/offers">See all</a>
      </div>

      <div class="flex gap-3 overflow-x-auto pb-3">
        <div *ngFor="let o of (offers$ | async || [])" class="w-64 flex-shrink-0 rounded-lg bg-white p-3 shadow dark:bg-slate-800"
             (mouseenter)="setFeatured(o.image)" (focus)="setFeatured(o.image)" tabindex="0">
          <div class="text-sm font-semibold text-slate-900 dark:text-slate-50">{{ o.title }}</div>
          <div class="mt-1 text-xs text-slate-600 dark:text-slate-300">{{ o.restaurant }}</div>
        </div>
      </div>
    </section>

    <!-- Articles / Gourmet's Note: horizontal cards -->
    <section class="mt-6">
      <div class="mb-3 flex items-center justify-between">
        <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">
          {{ (lang$ | async) === 'TC' ? '飲食札記' : "Gourmet's Note" }}
        </h3>
        <a class="text-sm text-indigo-600 dark:text-indigo-400" routerLink="/articles">See all</a>
      </div>

      <div class="flex gap-3 overflow-x-auto pb-3">
        <article *ngFor="let a of (articles$ | async || [])" class="w-80 flex-shrink-0 rounded-lg bg-white p-3 shadow dark:bg-slate-800">
          <img [src]="a.image || 'assets/img/placeholder.jpg'" alt="article" class="h-36 w-full rounded object-cover" />
          <h4 class="mt-2 font-semibold text-slate-900 dark:text-slate-50">{{ a.title }}</h4>
          <p class="mt-1 line-clamp-3 text-sm text-slate-600 dark:text-slate-300">{{ a.excerpt }}</p>
        </article>
      </div>
    </section>

    <!-- Latest reviews: horizontal testimonial snippets -->
    <section class="mt-6">
      <div class="mb-3 flex items-center justify-between">
        <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">
          {{ (lang$ | async) === 'TC' ? '最近評論' : 'Latest review' }}
        </h3>
        <a class="text-sm text-indigo-600 dark:text-indigo-400" routerLink="/reviews">See all</a>
      </div>

      <div class="flex gap-3 overflow-x-auto pb-3">
        <div *ngFor="let r of (reviews$ | async || [])" class="w-80 flex-shrink-0 rounded-lg bg-white p-3 shadow dark:bg-slate-800">
          <div class="flex items-center gap-3">
            <img [src]="r.avatar || 'assets/img/placeholder.jpg'" alt="avatar" class="h-10 w-10 rounded-full object-cover" />
            <div>
              <div class="text-sm font-semibold text-slate-900 dark:text-slate-50">{{ r.name }}</div>
              <div class="text-xs text-slate-600 dark:text-slate-300">{{ r.meta }}</div>
            </div>
          </div>
          <p class="mt-2 line-clamp-4 text-sm text-slate-700 dark:text-slate-300">{{ r.text }}</p>
        </div>
      </div>
    </section>

    <!-- Trending restaurants: horizontal feed like OpenRice -->
    <section class="mt-6">
      <div class="mb-3 flex items-center justify-between">
        <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">
          {{ (lang$ | async) === 'TC' ? '熱門餐廳' : "Trending restaurants" }}
        </h3>
        <a class="text-sm text-indigo-600 dark:text-indigo-400" routerLink="/restaurants">See all</a>
      </div>

      <div class="flex gap-3 overflow-x-auto pb-3">
        <div *ngFor="let r of (restaurants$ | async || [])" class="w-80 flex-shrink-0 rounded-lg bg-white p-3 shadow dark:bg-slate-800">
          <img [src]="r.image || 'assets/img/placeholder.jpg'" alt="rest" class="h-36 w-full rounded object-cover" />
          <div class="mt-2">
            <h4 class="font-semibold text-slate-900 dark:text-slate-50">{{ (lang$ | async) === 'TC' ? r.Name_TC : r.Name_EN }}</h4>
            <p class="mt-1 line-clamp-3 text-xs text-slate-600 dark:text-slate-300">{{ (lang$ | async) === 'TC' ? r.Address_TC : r.Address_EN }}</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer / mobile promo -->
    <footer class="mt-8">
      <div class="flex flex-col gap-4 rounded-lg bg-white p-6 shadow dark:bg-slate-800">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold text-slate-900 dark:text-slate-100">Mobile App / 手機程式 Pour Rice 倒米</h4>
            <p class="text-sm text-slate-600 dark:text-slate-300">Download for deals & location features.</p>
          </div>
          <div class="flex gap-2">
            <img src="assets/icon/App_Store.png" alt="App Store" class="h-10" />
            <img src="assets/icon/Google_Play.png" alt="Google Play" class="h-10" />
          </div>
        </div>

        <!-- Footer links and CTA -->
        <div class="flex flex-wrap items-center justify-between gap-3">
          <nav class="flex flex-wrap gap-3 text-sm text-slate-700 dark:text-slate-200">
            <a routerLink="/about">About / 關於我們</a>
            <a routerLink="/vegevents">Veg Events / 素食活動</a>
            <a routerLink="/faq">FAQ</a>
            <a routerLink="/terms">Terms</a>
            <a routerLink="/community">Community / 社群</a>
          </nav>

          <div class="flex items-center gap-3">
            <a class="rounded bg-indigo-600 px-3 py-2 text-white dark:bg-indigo-500" routerLink="/write-review">寫食評 / Write a review</a>
          </div>
        </div>
      </div>
    </footer>

  </main>
</ion-content>