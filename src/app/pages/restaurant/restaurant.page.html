<!-- Restaurant detail page (null-safe, bilingual, responsive)
     Two grids: 1) hero image + title, 2) information cells (6 cells)
     Responsive behaviour:
       - mobile: 1 columns per row (ion-col size="12")
       - non-mobile: 3 column per row (ion-col size="12" on md+)
-->
<ion-header translucent><br>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>
      {{ (lang$ | async) === 'TC' ? (restaurant?.Name_TC ?? '-') : (restaurant?.Name_EN ?? '-') }}
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen>
  <!-- Grid 1: Hero image and centred name -->
  <ion-grid class="hero-grid ion-no-padding">
    <ion-row class="image-row">
      <ion-col size="12" class="image-col">
        <img [src]="imageUrlOrPlaceholder()"
             alt="{{ (lang$ | async) === 'TC' ? (restaurant?.Name_TC ?? '-') : (restaurant?.Name_EN ?? '-') }}"
             class="restaurant-image" />
        <div class="name-overlay">
          <h1>{{ (lang$ | async) === 'TC' ? (restaurant?.Name_TC ?? '-') : (restaurant?.Name_EN ?? '-') }}</h1>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Grid 2: Six info cells (responsive) -->
  <ion-grid class="info-grid ion-no-padding">
    <ion-row class="cells-row">
      <!-- Location: Address then District -->
      <ion-col class="cell no-border" size="12" size-md="4">
        <div class="cell-title">{{ (lang$ | async) === 'TC' ? '位置' : 'Location' }}</div>
        <div class="cell-content small">
          <div>{{ (lang$ | async) === 'TC' ? (restaurant?.Address_TC ?? '-') : (restaurant?.Address_EN ?? '-') }}</div>
          <div class="muted">{{ (lang$ | async) === 'TC' ? (restaurant?.District_TC ?? '-') : (restaurant?.District_EN ?? '-') }}</div>
        </div>
      </ion-col>

      <!-- Map: Leaflet or coordinates -->
      <ion-col class="cell no-border" size="12" size-md="4">
        <div class="cell-title">{{ (lang$ | async) === 'TC' ? '地圖' : 'Map' }}</div>
        <div class="cell-content">
          <div *ngIf="(restaurant?.Latitude != null) && (restaurant?.Longitude != null); else coordsOnly">
            <div id="restaurant-map" class="map-container" aria-hidden="false"></div>
          </div>
          <ng-template #coordsOnly>
            <div class="muted small">
              {{ restaurant ? (restaurant.Latitude != null ? restaurant.Latitude : '-') : '-' }},
              {{ restaurant ? (restaurant.Longitude != null ? restaurant.Longitude : '-') : '-' }}
            </div>
          </ng-template>
        </div>
      </ion-col>

      <!-- Contacts -->
      <ion-col class="cell no-border" size="12" size-md="4">
        <div class="cell-title">{{ (lang$ | async) === 'TC' ? '聯絡方式' : 'Contacts' }}</div>
        <div class="cell-content small">
          <div>Tel: {{ restaurant?.Contacts?.Phone ?? '-' }}</div>
          <div>Email: {{ restaurant?.Contacts?.Email ?? '-' }}</div>
          <div *ngIf="restaurant?.Contacts?.Website; else noWebsite">
            <a target="_blank" rel="noopener noreferrer" [href]="restaurant?.Contacts?.Website">{{ restaurant?.Contacts?.Website }}</a>
          </div>
          <ng-template #noWebsite>-</ng-template>
        </div>
      </ion-col>
    </ion-row>

    <ion-row class="cells-row">
      <!-- Information: Opening Hours and Seats -->
      <ion-col class="cell no-border" size="12" size-md="4">
        <div class="cell-title">{{ (lang$ | async) === 'TC' ? '資訊' : 'Information' }}</div>
        <div class="cell-content small">
          <div>
            <div class="font-medium">{{ (lang$ | async) === 'TC' ? '開放時間' : 'Opening Hours' }}</div>
            <div *ngIf="restaurant?.Opening_Hours; else noHours">
              <div *ngFor="let pair of (restaurant?.Opening_Hours | keyvalue)">
                {{ pair.key }}: {{ pair.value ?? '-' }}
              </div>
            </div>
            <ng-template #noHours>-</ng-template>
          </div>
          <div class="mt-1">
            <div class="font-medium">{{ (lang$ | async) === 'TC' ? '座位' : 'Seats' }}</div>
            <div>{{ restaurant?.Seats ?? '-' }}</div>
          </div>
        </div>
      </ion-col>

      <!-- Keywords -->
      <ion-col class="cell no-border" size="12" size-md="4">
        <div class="cell-title">{{ (lang$ | async) === 'TC' ? '關鍵字' : 'Keywords' }}</div>
        <div class="cell-content small">
          <ng-container *ngIf="(lang$ | async) === 'TC'; else enKeywords">
            <div *ngFor="let k of (restaurant?.Keyword_TC ?? [])">{{ k }}</div>
            <div *ngIf="!(restaurant?.Keyword_TC?.length) && !(restaurant?.Keyword_EN?.length)">-</div>
          </ng-container>
          <ng-template #enKeywords>
            <div *ngFor="let k of (restaurant?.Keyword_EN ?? [])">{{ k }}</div>
            <div *ngIf="!(restaurant?.Keyword_EN?.length) && !(restaurant?.Keyword_TC?.length)">-</div>
          </ng-template>
        </div>
      </ion-col>

      <!-- Menu -->
      <ion-col class="cell no-border" size="12" size-md="4">
        <div class="cell-title">{{ (lang$ | async) === 'TC' ? '餐牌' : 'Menu' }}</div>
        <div class="cell-content small">
          <div *ngIf="(restaurant?.Menu ?? []).length > 0; else noMenu">
            <ion-list lines="none">
              <ion-item *ngFor="let menuItem of (restaurant?.Menu ?? [])">
                <ion-label>
                  <div class="font-medium">
                    {{ (lang$ | async) === 'TC' ? (menuItem?.Name_TC ?? menuItem?.Name_EN ?? '-') : (menuItem?.Name_EN ?? menuItem?.Name_TC ?? '-') }}
                  </div>
                  <div class="muted small">{{ (menuItem?.Price != null) ? ('$' + menuItem.Price) : '-' }}</div>
                </ion-label>
              </ion-item>
            </ion-list>
          </div>
          <ng-template #noMenu>-</ng-template>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Pull-to-refresh to reload the restaurant -->
  <ion-refresher slot="fixed" (ionRefresh)="ngAfterViewInit()" pullFactor="0.5">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- Loading and error states -->
  <ion-loading [isOpen]="isLoading" message="Loading..."></ion-loading>
  <ion-toast *ngIf="errorMessage" [message]="errorMessage" duration="3000"></ion-toast>
</ion-content>